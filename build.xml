<?xml version="1.0"?>

<project name="vaadin" basedir="." default="package" xmlns:ivy="antlib:org.apache.ivy.ant">
	<include file="common.xml" as="common" />

	<path id="vaadin.buildhelpers.classpath" location="${vaadin.basedir}/buildhelpers/result/classes" />

	<!-- ================================= 
          target: all              
         ================================= -->
	<!--<target name="all" description="Compiles all parts of the project" depends="buildhelpers,theme-compiler,shared,server,client">-->
	<target name="package" description="Compiles and packages all modules in the project" depends="buildorder">
		<subant buildpathref="build-path" target="publish-local">
		</subant>
	</target>

	<target name="buildorder">
		<!-- Find out a good build order -->
		<ivy:buildlist reference="build-path">
			<fileset dir="." includes="**/build.xml">
				<exclude name="build.xml" />
				<exclude name="build/**" />
			</fileset>
		</ivy:buildlist>
	</target>
	<target name="clean" depends="buildorder">
		<subant buildpathref="build-path" target="clean">
		</subant>
		<delete dir="result" />
		<!-- Clean IVY cache (~/.ivy2) so no old artifacts are fetched from there (leave everything but Vaadin artifacts) -->
		<delete dir="${ivy.cache.dir}/com.vaadin">
		</delete>

	</target>

	<target name="tests" depends="buildorder">
		<subant buildpathref="build-path" target="tests">
		</subant>
	</target>

</project>
